<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.1.0/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.1.0/dist/MarkerCluster.Default.css">
    <script src="https://unpkg.com/leaflet.markercluster@1.1.0/dist/leaflet.markercluster.js"></script>
    <script src="https://unpkg.com/leaflet-ajax@2.1.0/dist/leaflet.ajax.min.js"></script>
    <title>Title</title>
</head>

<body>
    <div id="mapid" style="height: 600px;"></div>

    <script>
        var signAttribution =
            'Sign data &copy; <a href="http://www.lounaistieto.fi/blog/2016/03/30/turun-kaupungin-liikennemerkit/">Turun kaupunki</a>, ' +
            '<a href="https://creativecommons.org/licences/by/4.0/deed.fi">CC-BY</a>';

        var mymap = L.map('mapid').setView([60.440963, 22.25122], 10);
        var signMapping;

        L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution:
                'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
            id: 'mapbox.streets'
        }).addTo(mymap);

        var clusterGroup = L.markerClusterGroup({
            // attribution in geojsonLayer is ignored
            attribution: signAttribution
        });
        var geojsonLayer = new L.GeoJSON.AJAX("liikennemerkit.json");
        mymap.addLayer(clusterGroup);

        geojsonLayer.on("data:loaded", function () {
            // add geojson layer into cluster layer after data is loaded
            clusterGroup.addLayer(geojsonLayer);
        });

        // load mapping
        $.getJSON("merkit_map.json", function (json) {
            signMapping = json;
        });

        var popup = L.popup();
        function onMapClick(e) {
            prop = e.layer.feature.properties;
            console.log(prop);
            popup.setLatLng(e.latlng)
                .setContent(signMapping[prop["signtype"]])
                .openOn(mymap);
        }
        geojsonLayer.on("click", onMapClick)
    </script>
</body>

</html>